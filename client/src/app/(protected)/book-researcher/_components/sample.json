{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9a46583",
   "metadata": {},
   "outputs": [],
   "source": [
    "# imports \n",
    "\n",
    "import os\n",
    "from dotenv import load_dotenv\n",
    "from crewai_tools import SerperDevTool\n",
    "from crewai import Agent, Task, Crew\n",
    "\n",
    "from src.event_listener.print_all_eventlistener import PrintAllEventsListener"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9c23b745",
   "metadata": {},
   "outputs": [],
   "source": [
    "class FinancialResearcherCrew:\n",
    "\n",
    "    def __init__(self, openai_llm, gemini_llm):\n",
    "        load_dotenv()\n",
    "        os.environ[\"SERPER_API_KEY\"] = os.getenv('SERPER_API_KEY')\n",
    "\n",
    "        self.agents = []\n",
    "        self.tasks = [] \n",
    "        self.openai_llm = openai_llm\n",
    "        self.gemini_llm = gemini_llm\n",
    "\n",
    "    def define_agent(self):\n",
    "        self.research_agent = Agent(\n",
    "            llm = self.openai_llm,\n",
    "            role=\"Senior Financial Researcher for {company}\",\n",
    "            goal=\"Research the company, news and potential for {company}\",\n",
    "            backstory=\"\"\"You're a seasoned financial researcher with a talent for finding\n",
    "            the most relevant information about {company}.\n",
    "            Known for your ability to find the most relevant\n",
    "            information and present it in a clear and concise manner.\"\"\",\n",
    "            tools=[SerperDevTool()],\n",
    "        )\n",
    "\n",
    "        self.analyst_agent= Agent(\n",
    "            llm = self.openai_llm,\n",
    "            role=\"Market Analyst and Report writer focused on {company}\",\n",
    "            goal=\"\"\" Analyze company {company} and create a comprehensive, well-structured report\n",
    "            that presents insights in a clear and engaging way\"\"\",\n",
    "            backstory=\"\"\" You're a meticulous, skilled analyst with a background in financial analysis\n",
    "            and company research. You have a talent for identifying patterns and extracting\n",
    "            meaningful insights from research data, then communicating\n",
    "            those insights through well crafted reports\"\"\",\n",
    "            tools=[SerperDevTool()],\n",
    "        )\n",
    "\n",
    "        self.agents.append(self.research_agent)\n",
    "        self.agents.append(self.analyst_agent)\n",
    " \n",
    "    def define_task(self):\n",
    "        self.research_task = Task(\n",
    "            description=\"\"\"Conduct thorough research on company {company}. Focus on:\n",
    "            1. Current company status and health\n",
    "            2. Historical company performance\n",
    "            3. Major challenges and opportunities\n",
    "            4. Recent news and events\n",
    "            5. Future outlook and potential developments\n",
    "\n",
    "            Make sure to organize your findings in a structured format with clear sections.\"\"\",\n",
    "            expected_output=\"\"\" A comprehensive research document with well-organized sections covering\n",
    "            all the requested aspects of {company}. Include specific facts, figures,\n",
    "            and examples where relevant.\"\"\",\n",
    "            agent=self.research_agent\n",
    "        )\n",
    "\n",
    "        self.analysis_task = Task(\n",
    "            description=\"\"\"Analyze the research findings and create a comprehensive report on {company}.\n",
    "            Your report should:\n",
    "            1. Begin with an executive summary\n",
    "            2. Include all key information from the research\n",
    "            3. Provide insightful analysis of trends and patterns\n",
    "            4. Offer a market outlook for company, noting that this should not be used for trading decisions\n",
    "            5. Be formatted in a professional, easy-to-read style with clear headings\"\"\",\n",
    "            expected_output=\"\"\"  A polished, professional report on {company} that presents the research\n",
    "            findings with added analysis and insights. The report should be well-structured\n",
    "            with an executive summary, main sections, and conclusion.\"\"\",\n",
    "            agent=self.analyst_agent\n",
    "        )\n",
    "\n",
    "        self.tasks.append(self.research_task)\n",
    "        self.tasks.append(self.analysis_task)\n",
    "\n",
    "    \n",
    "    def crew_formation(self):\n",
    "\n",
    "        self.define_agent()\n",
    "        self.define_task()\n",
    "\n",
    "        crew = Crew(\n",
    "            agents=self.agents,\n",
    "            tasks=self.tasks,\n",
    "            event_listener=PrintAllEventsListener()\n",
    "        )\n",
    "\n",
    "        return crew\n",
    "    "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.12.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
